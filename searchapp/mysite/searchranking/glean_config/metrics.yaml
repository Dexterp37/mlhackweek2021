# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# This file defines the metrics that are recorded by the Glean SDK.
# APIs to use these pings are automatically generated at build time using
# the `glean_parser` PyPI package.

# Metrics in this file may make use of SDK reserved ping names. See
# https://mozilla.github.io/glean/book/dev/core/internal/reserved-ping-names.html
# for additional information.

---
# Schema
$schema: moz://mozilla.org/schemas/glean/metrics/2-0-0

# Category
search:
  # generic
  search_engine:
    type: string
    send_in_pings:
      - action
    description: |
      Search engine used
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  search_text:
    type: string
    send_in_pings:
      - action
    description: |
      Submitted search text
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  session_id:
    type: string
    send_in_pings:
      - action
    description: |
      Session id
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never

  # selected
  selection:
    type: event
    description: |
      Captures user result selection.
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    send_in_pings:
      - action
    expires: never
    extra_keys:
      url:
        description: |
          Selected search result url
        type: string
      hostname:
        type: string
        description: |
          Selected search result hostname (domain)
      title:
        type: string
        description: |
          Selected search result title
      short_description:
        type: string
        description: |
          Initial text of search result
          Selected search result short description
      preamble:
        type: string
        description: |
          Selected search result starting text (e.g. 'x days ago', '1 of 20')
      selected:
        type: boolean  # may not be needed, event type implies this.
        description: |
          Indicates whether the URL was selected by user
      position:
        type: quantity
        description: |
          Selected search result position in list of results
  url_select_timestamp:
    type: datetime
    send_in_pings:
      - action
    description: |
      Timestamp of selection action
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never

  # unselected
  unselected_url:
    type: labeled_string
    send_in_pings:
      - action
    description: |
      Unselected search result url
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  unselected_hostname:
    type: labeled_string
    send_in_pings:
      - action
    description: |
      Unselected search result hostname (domain)
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  unselected_title:
    type: labeled_string
    send_in_pings:
      - action
    description: |
      Unselected search result title
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  unselected_short_description:
    type: labeled_string
    send_in_pings:
      - action
    description: |
      Initial text of search result
      Unselected search result short description
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  unselected_preamble:
    type: labeled_string
    send_in_pings:
      - action
    description: |
      Unselected search result starting text (e.g. 'x days ago', '1 of 20')
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
  unselected_position:
    type: labeled_string
    send_in_pings:
      - action
    description: |
      Unselected search result position in list of results
    notification_emails:
      - gleonard@mozilla.com
    bugs:
      - https://example/123456789/
    data_reviews:
      - http://example.com/path/to/data-review
    expires: never
    unit: position in list
